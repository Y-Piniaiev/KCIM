# Лабораторна робота №1: Опис імітаційної моделі "Fruit Wars"

## 1. Загальна інформація про модель

**Fruit Wars** - це мультиагентна імітаційна модель, що демонструє, як економічне середовище з ненульовою сумою може сприяти кооперації та знижувати рівень насильства. Модель симулює популяцію агентів-збирачів (foragers), які мандрують по карті в пошуках фруктових кущів, конкурують за ресурси та приймають рішення про співпрацю або конфлікт.

Основна ідея моделі полягає в демонстрації еволюційного процесу, де агенти з різними рівнями агресії конкурують за виживання. При збільшенні бонусу за співпрацю очікується зміщення еволюційної рівноваги в бік менш агресивних особин.

## 2. Параметри моделі

### 2.1 Внутрішні параметри агентів

Кожен агент-збирач має **240-бітний геном**, який кодує наступні характеристики:

- **Сила (Strength)**: визначає шанси на перемогу у бійці
- **Швидкість (Speed)**: визначає дистанцію переміщення за такт
- **Інтелект (Intelligence)**: впливає на загальну адаптивність

*Примітка: сума цих трьох атрибутів завжди дорівнює 60 (біти 0-119 геному)*

- **Реактивна агресія (Reactive-aggression)**: тенденція до загроз при прибутті до куща та при зустрічі з новими збирачами (біти 120-179)
- **Проактивна агресія (Proactive-aggression)**: тенденція до відповіді боєм на загрози (біти 180-239)
- **Енергія**: поточний запас енергії агента (потрібно 200+ для розмноження)
- **Вік**: кількість прожитих тактів
- **Статус**: foraging (збирання), fleeing (втеча), або пошук кущів

### 2.2 Керуючі параметри (налаштовуються перед запуском)

**Початкові параметри:**
- `initial-fruit-bushes` - початкова кількість фруктових кущів (діапазон: 0-100)
- `initial-foragers` - початкова кількість агентів-збирачів (діапазон: 0-100)

**Параметри виконання:**
- `bush-growth-chance` - ймовірність появи нового куща на кожному такті (діапазон: 0-6%)
- `ticks-to-flee` - кількість тактів втечі перед пошуком нового куща (діапазон: 0-100)
- `rate-of-mutation` - ймовірність мутації кожного біта при розмноженні (діапазон: 0.1-10%)
- `collaboration-bonus` - коефіцієнт бонусу за співпрацю (діапазон: 0-5)
- `max-age` - максимальний вік агента в тактах (діапазон: 0-500)

**Параметри візуалізації:**
- `show-energy?` - відображення поточної енергії агентів
- `visualization` - режим кольорового кодування агентів за обраним атрибутом

## 3. Показники роботи моделі

- **Популяція збирачів** - загальна кількість живих агентів
- **Середня популяція** - усереднений розмір популяції за період симуляції
- **Кількість фруктових кущів** - доступні ресурси в середовищі
- **Розподіл атрибутів** - гістограми сили, швидкості, інтелекту та агресії
- **Співвідношення вбивств до інших смертей** - індикатор рівня насильства
- **Швидкість збирання (Forage Rate)** - ефективність добування ресурсів
- **Середні значення реактивної та проактивної агресії** - еволюційні тренди

## 4. Алгоритм роботи моделі

### 4.1 Основний цикл (кожен такт)

Для кожного агента-збирача:

1. **Переміщення:**
   - Якщо немає кущів поблизу або статус "втеча" → рух у випадковому напрямку
   - Якщо є кущ поблизу → рух до нього
   - Витрата 1 одиниці енергії

2. **Прибуття до куща (arrival procedure):**
   - Якщо немає інших агентів → початок збирання
   - Якщо є інші агенти → рішення про загрозу або співпрацю (ймовірнісно, базується на реактивній агресії)
   
   **При виборі загрози:**
   - Інші агенти вирішують втікати чи боротися (базується на проактивній агресії)
   - Якщо хтось бореться → бій з ймовірністю перемоги залежно від різниці сил
   - Переможець залишається, переможені гинуть
   
   **При виборі співпраці:**
   - Якщо один агент присутній → він вирішує допустити чи загрожувати
   - Якщо кілька агентів → новоприбулий приєднується до збирання

3. **Збирання ресурсів:**
   - Якщо статус "foraging" → отримання енергії з куща
   - Кущ втрачає енергію; при виснаженні - кущ гине, агенти змінюють статус

4. **Розмноження:**
   - При енергії >200 → створення нащадка, втрата 100 енергії
   - Геном передається з можливими мутаціями (rate-of-mutation)

5. **Смерть:**
   - При енергії ≤0 або віці >max-age → смерть агента

### 4.2 Механізм співпраці

Параметр `collaboration-bonus` впливає на швидкість збирання при наявності кількох агентів на одному кущі. Вищі значення роблять кооперацію вигіднішою, створюючи еволюційний тиск на користь менш агресивних генотипів.

## 5. Обчислювальні експерименти

### Експеримент 1: Вплив бонусу співпраці на рівень агресії

**Мета:** Дослідити, як зміна параметра `collaboration-bonus` впливає на середній рівень реактивної агресії в популяції.

**Початкові умови:**
- `initial-fruit-bushes` = 40
- `initial-foragers` = 40
- `bush-growth-chance` = 3
- `ticks-to-flee` = 49
- `rate-of-mutation` = 1 (1%)
- `max-age` = 500
- Тривалість симуляції: 3000 тактів

**Змінний параметр:** `collaboration-bonus` (1, 2, 3, 4, 5)

**Результати:**

| collaboration-bonus | Середня реактивна агресія (такт 3000) | Популяція (такт 3000) |
|---------------------|---------------------------------------|-----------------------|
| 1                   | 30                                    | 12                    |
| 2                   | 28                                    | 37                    |
| 3                   | 27                                    | 58                    |
| 4                   | 25                                    | 67                    |
| 5                   | 24                                    | 78                    |

**Графіки:**

```
Залежність середньої реактивної агресії від collaboration-bonus:

Агресія
  30 ●
     |  ●
  28 |     ●
     |        ●
  26 |           ●
  24 |__________________
     1   2   3   4   5
        Collaboration Bonus


Залежність популяції від collaboration-bonus:

Популяція
  80 |              ●
  70 |           ●
  60 |        ●
  40 |     ●
  20 |  ●
   0 |__________________
     1   2   3   4   5
        Collaboration Bonus
```

**Висновки:** 

Експеримент демонструє два важливі взаємопов'язані ефекти співпраці:

1. **Зниження агресії:** При збільшенні `collaboration-bonus` від 1 до 5 спостерігається поступове зниження середньої реактивної агресії з 30 до 24 (зменшення на 20%). Це підтверджує гіпотезу про те, що економічні стимули до кооперації сприяють еволюції менш агресивної поведінки.

2. **Зростання популяції:** Одночасно відбувається драматичне збільшення розміру популяції - з 12 до 78 особин (зростання у 6.5 разів). Це вказує на те, що кооперативна стратегія значно підвищує виживаність та репродуктивний успіх агентів.

3. **Нелінійний ефект:** Найбільший приріст популяції спостерігається при переході від collaboration-bonus=1 до collaboration-bonus=3 (з 12 до 58), після чого темпи зростання сповільнюються. Це свідчить про наявність точки насичення, після якої додаткові стимули до співпраці дають менший ефект.

**Загальний висновок:** Модель підтверджує, що в умовах обмежених ресурсів кооперація є еволюційно вигідною стратегією, яка не лише знижує внутрішньовидове насильство, але й суттєво покращує загальну життєздатність популяції.

---

### Експеримент 2: Вплив максимального віку на розмір популяції

**Мета:** Дослідити, як тривалість життя агентів впливає на стабільний розмір популяції.

**Початкові умови:**
- `initial-fruit-bushes` = 40
- `initial-foragers` = 40
- `bush-growth-chance` = 3
- `ticks-to-flee` = 49
- `rate-of-mutation` = 1
- `collaboration-bonus` = 3
- Тривалість симуляції: 2000 тактів

**Змінний параметр:** `max-age` (100, 200, 300, 400, 500)

**Результати:**

| max-age | Популяція (такт 2000) | Avg Population |
|---------|----------------------|----------------|
| 100     | 0                    | 21             |
| 200     | 0                    | 47             |
| 300     | 20                   | 62             |
| 400     | 33                   | 70             |
| 500     | 39                   | 73             |

**Графіки:**

```
Залежність популяції від максимального віку:

Популяція (такт 2000)
  40 |                 ●
     |              ●
  30 |           ●
  20 |        ●
  10 |
   0 ●____●____________
    100 200 300 400 500
          Max Age


Залежність середньої популяції від максимального віку:

Avg Population
  80 |                 ●
  70 |              ●
  60 |           ●
  50 |        ●
  20 |     ●
   0 |__________________
    100 200 300 400 500
          Max Age
```

**Висновки:**

Експеримент виявив критичний вплив тривалості життя на виживаність популяції:

1. **Критичний поріг виживання:** При `max-age` ≤ 200 популяція повністю вимирає до такту 2000 (популяція = 0). Це свідчить про те, що існує мінімальна тривалість життя, необхідна для підтримання популяції в даних умовах середовища.

2. **Зона стабілізації:** Починаючи з `max-age` = 300, популяція стає життєздатною. Спостерігається поступове зростання як кінцевої популяції (з 20 до 39), так і середньої популяції за весь період (з 62 до 73).

3. **Ефект насичення:** При збільшенні `max-age` від 300 до 500 приріст популяції сповільнюється (з 20 до 39 - приріст на 95%, тоді як середня популяція зростає лише на 18%). Це вказує на те, що при `max-age` > 300 інші фактори (доступність ресурсів, конкуренція) стають більш обмежуючими, ніж тривалість життя.

4. **Середня vs кінцева популяція:** Цікаво, що середня популяція (Avg Population) завжди вища за кінцеву, особливо при низьких значеннях `max-age`. Це означає, що популяції з коротким життям спочатку можуть бути чисельними, але поступово деградують і вимирають.

**Загальний висновок:** Тривалість життя є критичним параметром для виживання популяції. Існує чіткий поріг (~250-300 тактів), нижче якого популяція не може підтримувати себе незалежно від інших умов. Це демонструє важливість балансу між швидкістю розмноження та тривалістю життя для еволюційного успіху.

---

### Експеримент 3: Вплив початкової кількості кущів на швидкість збирання

**Мета:** Дослідити, як кількість ресурсів на старті впливає на ефективність збирання їжі агентами та розмір популяції.

**Початкові умови:**
- `initial-foragers` = 40
- `bush-growth-chance` = 3
- `ticks-to-flee` = 49
- `rate-of-mutation` = 1
- `collaboration-bonus` = 3
- `max-age` = 500
- Тривалість симуляції: 2000 тактів

**Змінний параметр:** `initial-fruit-bushes` (5, 10, 20, 30, 40)

**Результати:**

| initial-fruit-bushes | Forage Rate (з графіку) | Популяція (такт 2000) |
|----------------------|-------------------------|-----------------------|
| 5                    | 17                      | 55                    |
| 10                   | 16                      | 34                    |
| 20                   | 15                      | 35                    |
| 30                   | 14                      | 31                    |
| 40                   | 12                      | 32                    |

**Графіки:**

```
Залежність Forage Rate від початкової кількості кущів:

Forage Rate
  18 |  ●
  17 |
  16 |     ●
  15 |        ●
  14 |           ●
  12 |              ●
   0 |__________________
     5  10  20  30  40
      Initial Bushes


Залежність популяції від початкової кількості кущів:

Популяція
  60 |  ●
  50 |
  40 |
  30 |     ●  ●  ●  ●
  20 |
   0 |__________________
     5  10  20  30  40
      Initial Bushes
```

**Висновки:**

Експеримент виявив несподіваний та контрінтуїтивний результат:

1. **Парадоксальна залежність швидкості збирання:** Всупереч очікуванням, при збільшенні початкової кількості кущів з 5 до 40 швидкість збирання (Forage Rate) **знижується** з 17 до 12. Це протилежно до гіпотези "більше ресурсів = вища ефективність збирання".

2. **Оптимум при дефіциті:** Найвищі показники швидкості збирання та популяції спостерігаються при найменшій кількості початкових кущів (5). При цьому популяція досягає максимуму в 55 особин, що значно перевищує інші варіанти.

3. **Стабілізація при надлишку:** При збільшенні кількості кущів від 10 до 40 популяція стабілізується на рівні 31-35 особин, незалежно від початкової кількості ресурсів.

**Можливі пояснення парадоксу:**

- **Ефект конкуренції:** При малій кількості кущів агенти змушені більш інтенсивно конкурувати та ефективніше використовувати ресурси, що підвищує загальну швидкість збирання.

- **Динамічна регенерація:** Параметр `bush-growth-chance` = 3 забезпечує постійну появу нових кущів. При початковому дефіциті кущів система швидко досягає оптимального балансу між популяцією та ресурсами.

- **Поведінкові зміни:** При надлишку кущів агенти можуть поводитися менш ефективно (більше часу на пошук, менша кооперація), що знижує загальну швидкість збирання.

- **Еволюційний тиск:** Жорсткі умови на початку (5 кущів) можуть створити сильніший еволюційний відбір, залишаючи найбільш ефективних агентів.

**Загальний висновок:** Модель демонструє, що початкова кількість ресурсів не завжди прямо корелює з ефективністю їх використання. В умовах динамічної регенерації ресурсів (постійна поява нових кущів) початковий дефіцит може призводити до формування більш ефективної та життєздатної популяції. Це підтверджує принцип, що "надто комфортні умови" не завжди сприяють оптимальному розвитку системи.

## 6. Загальні висновки

Проведені експерименти з моделлю **Fruit Wars** дозволили виявити ключові закономірності взаємодії агентів у конкурентному середовищі:

1. **Кооперація як ключовий фактор успіху:** Експеримент 1 підтвердив, що економічні стимули до співпраці (collaboration-bonus) не лише знижують агресію на 20%, але й драматично підвищують життєздатність популяції (зростання у 6.5 разів). Це демонструє еволюційну перевагу кооперативних стратегій над агресивними.

2. **Критичність тривалості життя:** Експеримент 2 виявив існування чіткого порогу виживання (max-age ≈ 250-300). Популяції з недостатньою тривалістю життя не можуть підтримувати себе незалежно від інших параметрів, що підкреслює важливість балансу між швидкістю розмноження та довголіттям.

3. **Парадокс початкових ресурсів:** Експеримент 3 продемонстрував несподіваний результат - початковий дефіцит ресурсів може призводити до формування більш ефективної популяції. Це вказує на складність взаємодій у екосистемі, де оптимальні умови не завжди очевидні.

4. **Системна складність:** Усі три експерименти показують, що поведінка мультиагентної системи не завжди є інтуїтивною. Непрямі ефекти, зворотні зв'язки та еволюційні процеси створюють складну динаміку, яка вимагає ретельного емпіричного дослідження.

**Практичне значення:** Результати моделювання мають значення для розуміння еволюції соціальної поведінки, оптимізації систем управління ресурсами та проектування стійких екосистем. Модель підтверджує, що довгострокова стабільність систем досягається не через максимізацію окремих параметрів, а через збалансовану взаємодію багатьох факторів.